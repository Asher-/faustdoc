# Faust Quick Reference

This folder contains the latex source of the Faust Quick Reference.
This latex source code is also used to generate md files intended to mkdocs.

To generate everything:
~~~~~~~~~~
$ make
~~~~~~~~~~

To generate the latex documentation only:
~~~~~~~~~~
$ make latex
~~~~~~~~~~

To generate the mkdocs files only:
~~~~~~~~~~
$ make mkdocs
~~~~~~~~~~

## Note about mkdocs support

md files for mkdocs are generated from the set of latex files using custom tools:

- awk scripts located in the `mkdocs/scripts` folder. 
- sed scripts located in the `mkdocs/scripts` folder. 
- rail2js: a converter from latex description to Javascript rail description. 

For everything to operate correctly there is a set of rules to be respected:

- every chapter MUST have a \label
- put every \label on a separate line
- encode your file in utf8 and avoid encoding accented characters in latex 
- don't use format tags enclosed in brackets e.g. {\it my text}, use explicit forms e.g \textit{my text}, the former is not translated by the conversion tools. 
- don't put more than one graphic in a figure section
- \begin and \end sections MUST be on a separate line
- \marginpar sections MUST be on a separate line and MUST be declared on a single line.


## Note about rail

- create a separate rail section for each declaration
- rail declaration name must be unique through all the document


## Best practices for conversion

- put \label before the labelled section: makes no difference for latex but in html, links point before the lmabelled section (and not after)
- a \label is explicit in html and appears as a link (when there is a reference to it): try to use the most significant names for the labels.


## Styling the output

Standard latex tags are converted into their equivalent in markup language, for example: \textbf{text} is converted to **text**.

Custom latex tags are translated into a style that you can freely modify. These styles are named according to the latex tag name. These are the following:

- caption
- paragraph
- smallcaps
- marginpar
- lstinline

Default values are provided by the `mkdocs/css/quickref.css` file.

There are 2 additional styles to control the rail output:

- railtitle: applied to the name of the rail declaration
- rail: applied to the whole rail graphic div

Note that the content of the rail diagrams can also be customized using the `mkdocs/rail/railroad-diagrams.css` file


## Note about the conversion scripts

### `sed` scripts

`sed` scripts perform transformations in place or cleanup tasks

- cleanup.sed: remove all the remaining latex markup tags
- labels.sed: used to generate a the fullrefs.sed script (see below)
- rail.sed: used to handle latex \railalias. This script is applied to the javascript output. It is build manually and thus, for any new railalias, a new sed command must be inserted in this script. 
- tags.sed: transform all tags that are expressed on a single line. For any new latex command, a new sed command must be inserted in this script.

### Generated `sed` scripts

These scripts are generated by the build process at the root of the mkdocs folder. 

- fullrefs.sed : replace the latex \ref tag with an md link. The fullrefs.sed script is generated from latex \label using the above mentionned labels.sed script
- index.sed : currently unused. Intended to handle latex \index tags.

### `awk` scripts

`awk` scripts are mainly intended to handle all the latex declarations that don't fit on a single line, like \begin...\end sections, tables, figures etc...

- scan-input.awk: scan latex \input tags and put the referred file inline. The output of the script is a single self-contained latex code.
- split.awk: split a self contained latex code into separate files using the chapters sections. Files are generated using the chapter associated label. In addition, the split script generates also a menu.txt file that contains chapters name associated to the corresponding file. This menu.txt file is almost ready to be used as mkdoc menu. The Makefile includes a `menu` target to finalize this menu regarding the actual mkdocs context. This script also collect all the \index tags (currently unused).

- equations.awk: transform \begin...\end equations  sections
- figures.awk: transform \includegraphics section into md image link. This script collects also the image that is copied to mkdocs. The expected image format is `png`. Note that when graphics are in a \begin...\end figure section, \caption tag is also collected.
- listings.awk: transform \begin...\end lstlisting  sections
- rail.awk: collect \begin...\end rail sections and put them in a file named using the rail declaration name. These output files are located in the rail folder.
- tables.awk: transform \table and \tabular sections.



